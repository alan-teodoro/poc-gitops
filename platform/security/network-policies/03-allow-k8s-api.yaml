---
# Allow Kubernetes API Network Policy
# Purpose: Allow Redis Enterprise Operator to communicate with Kubernetes API
# Required for: Operator functionality, resource management
# Ports: 443 (HTTPS), 6443 (K8s API)
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-k8s-api
  namespace: redis-enterprise
  labels:
    app: redis-enterprise
    component: network-policy
    security: k8s-api
spec:
  # Apply to all pods in namespace
  podSelector: {}
  
  policyTypes:
    - Egress
  
  egress:
    # Allow access to Kubernetes API server
    # Note: API server is typically in default namespace or master nodes
    # Using broad rule to allow API access (API server may be outside cluster network)
    - ports:
        - protocol: TCP
          port: 443
        - protocol: TCP
          port: 6443
      # No 'to' selector = allow to any destination on these ports
      # This is necessary because K8s API server may be on master nodes outside pod network

